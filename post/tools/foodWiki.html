<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>視覺化營養百科 | 營養百科</title>
    
    <!-- 引入 Tailwind CSS (快速排版與美化) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 引入 Chart.js (資料視覺化圖表) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- 引入 Google Fonts (提升閱讀體驗) -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- 引入 FontAwesome (圖示) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body { font-family: 'Noto Sans TC', sans-serif; }
        /* 自定義隱藏捲軸 */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- Header Component Container -->
    <div id="header-component"></div>

    <!-- 2. 搜尋與 Hero 區塊 -->
    <header class="bg-green-600 text-white py-12 md:py-20 relative overflow-hidden">
        <div class="absolute top-0 right-0 opacity-10 transform translate-x-10 -translate-y-10">
            <i class="fa-solid fa-carrot text-9xl"></i>
        </div>
        
        <div class="max-w-3xl mx-auto px-4 text-center relative z-10">
            <h1 class="text-3xl md:text-4xl font-bold mb-4">將數據轉化為您的健康決策</h1>
            <p class="text-green-100 mb-8 text-lg">全台最大的視覺化營養資料庫，輸入食材立即查詢。</p>
            
            <!-- 模擬搜尋框 -->
            <div class="relative max-w-lg mx-auto">
                <input type="text" id="searchInput" placeholder="試試看：酪梨、雞胸肉、鮭魚..." 
                    class="w-full pl-12 pr-4 py-4 rounded-full shadow-lg text-gray-800 focus:outline-none focus:ring-4 focus:ring-green-400 transition"
                    autocomplete="off">
                <i class="fa-solid fa-search absolute left-5 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                
                <!-- 搜尋建議下拉選單 (預設隱藏) -->
                <div id="searchResults" class="hidden absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-xl overflow-hidden text-left text-gray-800 border border-gray-100">
                    <!-- JS 動態生成結果 -->
                </div>
            </div>

            <!-- 快速標籤 -->
            <div class="mt-6 flex justify-center flex-wrap gap-2 text-sm">
                <!-- JS 動態生成 -->
            </div>
        </div>
    </header>

    <!-- 3. 主要內容區 (Main Content) -->
    <main class="max-w-6xl mx-auto px-4 py-8">
        <!-- 內容將由獨立頁面呈現，此處留白 -->
    </main>

    <!-- Footer Component Container -->
    <div id="footer-component"></div>

    <!-- Load Website Components -->
    <script src="../../assets/js/deus-header-component.js"></script>
    <script src="../../assets/js/deus-footer-component.js"></script>

    <!-- JavaScript 邏輯區 -->
    <script src="../../food/food_data.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Header and Footer
            const headerContainer = document.getElementById("header-component");
            if (headerContainer && window.DeusHeaderComponent) {
              new window.DeusHeaderComponent(headerContainer).setDebug(false);
            }
            const footerContainer = document.getElementById("footer-component");
            if (footerContainer && window.DeusFooterComponent) {
              new window.DeusFooterComponent(footerContainer).setDebug(false);
            }

            // 動態生成快速搜尋按鈕
            generateQuickSearchButtons();
            
            // 綁定搜尋框事件
            const searchInput = document.getElementById('searchInput');
            const searchResults = document.getElementById('searchResults');
            
            searchInput.addEventListener('input', (e) => {
                handleSearch(e.target.value);
            });
            
            // 點擊頁面其他地方時隱藏搜尋結果
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.relative')) {
                    searchResults.classList.add('hidden');
                }
            });
        });

        function generateQuickSearchButtons() {
            const container = document.querySelector('.mt-6.flex.justify-center');
            container.innerHTML = ''; // 清空現有按鈕
            const featuredKeys = ['avocado', 'chicken', 'salmon', 'sweet_potato']; // 精選項目

            featuredKeys.forEach(key => {
                const food = foodDatabase[key];
                if (food) {
                    const button = document.createElement('a');
                    button.href = `../food/${key}.html`;
                    button.className = 'quick-search-btn bg-green-700 bg-opacity-50 hover:bg-opacity-70 px-4 py-1 rounded-full transition';
                    button.innerHTML = `${food.icon} ${food.name}`;
                    container.appendChild(button);
                }
            });
        }
        
        function handleSearch(query) {
            const searchResults = document.getElementById('searchResults');
            if (query.trim() === '') {
                searchResults.classList.add('hidden');
                return;
            }

            const results = Object.keys(foodDatabase).filter(key => {
                const food = foodDatabase[key];
                const name = food.name.toLowerCase();
                const engName = food.engName.toLowerCase();
                const q = query.toLowerCase();
                return name.includes(q) || engName.includes(q);
            });

            searchResults.innerHTML = ''; // 清空舊結果
            if (results.length > 0) {
                results.slice(0, 5).forEach(key => { // 最多顯示5筆
                    const food = foodDatabase[key];
                    const item = document.createElement('a');
                    item.href = `../food/${key}.html`; // 直接連結到獨立頁面
                    item.className = 'block px-4 py-3 hover:bg-gray-100 transition text-sm';
                    item.innerHTML = `<span class="mr-2">${food.icon}</span> ${food.name} <span class="text-gray-400">(${food.engName})</span>`;
                    searchResults.appendChild(item);
                });
                searchResults.classList.remove('hidden');
            } else {
                const noResult = document.createElement('div');
                noResult.className = 'px-4 py-3 text-sm text-gray-500';
                noResult.innerText = '找不到相符的食物...';
                searchResults.appendChild(noResult);
                searchResults.classList.remove('hidden');
            }
        }
    </script>
</body>
</html>
